<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="GenomicDataCommons">
<title>The GenomicDataCommons Package • GenomicDataCommons</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The GenomicDataCommons Package">
<meta property="og:description" content="GenomicDataCommons">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GenomicDataCommons</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/overview.html">The GenomicDataCommons Package</a>
    <a class="dropdown-item" href="../articles/questions-and-answers.html">Questions and answers from over the years</a>
    <a class="dropdown-item" href="../articles/somatic_mutations.html">Working with simple somatic mutations</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Bioconductor/GenomicDataCommons/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="overview_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>The GenomicDataCommons Package</h1>
                        <h4 data-toc-skip class="author">Sean Davis &amp; Martin Morgan</h4>
            
            <h4 data-toc-skip class="date">Monday, November 07, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Bioconductor/GenomicDataCommons/blob/HEAD/vignettes/overview.Rmd" class="external-link"><code>vignettes/overview.Rmd</code></a></small>
      <div class="d-none name"><code>overview.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>The National Cancer Institute (NCI) has established the <a href="https://gdc.nci.nih.gov/" class="external-link">Genomic Data Commons</a> (GDC). The GDC provides the cancer research community with an open and unified repository for sharing and accessing data across numerous cancer studies and projects via a high-performance data transfer and query infrastructure. The <em>GenomicDataCommons</em> Bioconductor package provides basic infrastructure for querying, accessing, and mining genomic datasets available from the GDC. We expect that the Bioconductor developer and the larger bioinformatics communities will build on the <em>GenomicDataCommons</em> package to add higher-level functionality and expose cancer genomics data to the plethora of state-of-the-art bioinformatics methods available in Bioconductor.</p>
    </div>
    
<div class="section level2">
<h2 id="what-is-the-gdc">What is the GDC?<a class="anchor" aria-label="anchor" href="#what-is-the-gdc"></a>
</h2>
<p>From the <a href="https://gdc.cancer.gov/about-gdc" class="external-link">Genomic Data Commons (GDC) website</a>:</p>
<blockquote>
<p>The National Cancer Institute’s (NCI’s) Genomic Data Commons (GDC) is a data sharing platform that promotes precision medicine in oncology. It is not just a database or a tool; it is an expandable knowledge network supporting the import and standardization of genomic and clinical data from cancer research programs. The GDC contains NCI-generated data from some of the largest and most comprehensive cancer genomic datasets, including The Cancer Genome Atlas (TCGA) and Therapeutically Applicable Research to Generate Effective Therapies (TARGET). For the first time, these datasets have been harmonized using a common set of bioinformatics pipelines, so that the data can be directly compared. As a growing knowledge system for cancer, the GDC also enables researchers to submit data, and harmonizes these data for import into the GDC. As more researchers add clinical and genomic data to the GDC, it will become an even more powerful tool for making discoveries about the molecular basis of cancer that may lead to better care for patients.</p>
</blockquote>
<p>The <a href="https://gdc.cancer.gov/developers/gdc-data-model/gdc-data-model-components" class="external-link">data model for the GDC is complex</a>, but it worth a quick overview and a graphical representation is included here.</p>
<div class="figure">
<img src="all_nodes_040318.png" alt=""><p class="caption">The data model is encoded as a so-called property graph. Nodes represent entities such as Projects, Cases, Diagnoses, Files (various kinds), and Annotations. The relationships between these entities are maintained as edges. Both nodes and edges may have Properties that supply instance details.</p>
</div>
<p>The GDC API exposes these nodes and edges in a somewhat simplified set of <a href="https://en.wikipedia.org/wiki/Representational_state_transfer" class="external-link">RESTful</a> endpoints.</p>
</div>
<div class="section level2">
<h2 id="quickstart">Quickstart<a class="anchor" aria-label="anchor" href="#quickstart"></a>
</h2>
<p>This quickstart section is just meant to show basic functionality. More details of functionality are included further on in this vignette and in function-specific help.</p>
<p>This software is available at Bioconductor.org and can be downloaded via <code><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">BiocManager::install</a></code>.</p>
<p>To report bugs or problems, either <a href="https://github.com/Bioconductor/GenomicDataCommons/issues" class="external-link">submit a new issue</a> or submit a <code>bug.report(package='GenomicDataCommons')</code> from within R (which will redirect you to the new issue on GitHub).</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>Installation can be achieved via Bioconductor’s <code>BiocManager</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">'GenomicDataCommons'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomicDataCommons" class="external-link">GenomicDataCommons</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-connectivity-and-status">Check connectivity and status<a class="anchor" aria-label="anchor" href="#check-connectivity-and-status"></a>
</h3>
<p>The <em><a href="https://bioconductor.org/packages/3.16/GenomicDataCommons" class="external-link">GenomicDataCommons</a></em> package relies on having network connectivity. In addition, the NCI GDC API must also be operational and not under maintenance. Checking <code>status</code> can be used to check this connectivity and functionality.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/status.html">status</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $commit</span></span>
<span><span class="co">## [1] "4dd3680528a19ed33cfc83c7d049426c97bb903b"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $data_release</span></span>
<span><span class="co">## [1] "Data Release 35.0 - September 28, 2022"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $status</span></span>
<span><span class="co">## [1] "OK"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $tag</span></span>
<span><span class="co">## [1] "3.0.0"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $version</span></span>
<span><span class="co">## [1] 1</span></span></code></pre>
<p>And to check the status in code:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/status.html">status</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">status</span><span class="op">==</span><span class="st">"OK"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="find-data">Find data<a class="anchor" aria-label="anchor" href="#find-data"></a>
</h3>
<p>The following code builds a <code>manifest</code> that can be used to guide the download of raw data. Here, filtering finds gene expression files quantified as raw counts using <code>STAR</code> from ovarian cancer patients.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ge_manifest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/query.html">files</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span> <span class="va">cases.project.project_id</span> <span class="op">==</span> <span class="st">'TCGA-OV'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span> <span class="va">type</span> <span class="op">==</span> <span class="st">'gene_expression'</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span> <span class="va">analysis.workflow_type</span> <span class="op">==</span> <span class="st">'STAR - Counts'</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/manifest.html">manifest</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ge_manifest</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                     id data_format     access</span></span>
<span><span class="co">## 1 6431664a-4a19-4a02-8ea5-8478a295f391         TSV controlled</span></span>
<span><span class="co">## 2 db02a2f2-2d83-4486-b8a3-3b01d6f0a6f2         TSV       open</span></span>
<span><span class="co">## 3 d1737bd6-98b5-4c83-977d-007123b554b2         TSV controlled</span></span>
<span><span class="co">## 4 be11a1db-9919-47b8-bc06-90ce5f2c9b02         TSV       open</span></span>
<span><span class="co">## 5 49618db3-ba6f-442d-b001-6af64869461e         TSV controlled</span></span>
<span><span class="co">## 6 ffec2c19-e5f2-46c3-8fb7-02c620f06d8a         TSV controlled</span></span>
<span><span class="co">##                                                                     file_name</span></span>
<span><span class="co">## 1   2fb7ad5a-0ef2-4524-9fa8-4d61d1bb04e1.rna_seq.star_splice_junctions.tsv.gz</span></span>
<span><span class="co">## 2 2fb7ad5a-0ef2-4524-9fa8-4d61d1bb04e1.rna_seq.augmented_star_gene_counts.tsv</span></span>
<span><span class="co">## 3   8a7a4704-c698-4291-ba48-207895898a40.rna_seq.star_splice_junctions.tsv.gz</span></span>
<span><span class="co">## 4 8a7a4704-c698-4291-ba48-207895898a40.rna_seq.augmented_star_gene_counts.tsv</span></span>
<span><span class="co">## 5   872f7c22-17e4-4940-809b-a0970fde369b.rna_seq.star_splice_junctions.tsv.gz</span></span>
<span><span class="co">## 6   6ab54953-3d77-4239-bf4a-5a893cf9a43c.rna_seq.star_splice_junctions.tsv.gz</span></span>
<span><span class="co">##                           submitter_id           data_category       acl</span></span>
<span><span class="co">## 1 1fe77c9d-4a01-4de1-8217-d0a329800e60 Transcriptome Profiling phs000178</span></span>
<span><span class="co">## 2 16328313-f0d8-462d-a02b-5a6f2f4feabf Transcriptome Profiling      open</span></span>
<span><span class="co">## 3 047ec964-cda2-4932-a979-29ef0e5b109d Transcriptome Profiling phs000178</span></span>
<span><span class="co">## 4 8b20ea0f-57d5-420a-839d-03e9235a9536 Transcriptome Profiling      open</span></span>
<span><span class="co">## 5 836530f2-4019-42df-8b39-25f53a875350 Transcriptome Profiling phs000178</span></span>
<span><span class="co">## 6 8ff29681-9fc8-44a7-a7d1-fa11da07d81f Transcriptome Profiling phs000178</span></span>
<span><span class="co">##              type file_size                 created_datetime</span></span>
<span><span class="co">## 1 gene_expression   2800561 2021-12-13T20:58:10.452132-06:00</span></span>
<span><span class="co">## 2 gene_expression   4230648 2021-12-13T20:46:42.020696-06:00</span></span>
<span><span class="co">## 3 gene_expression   2538631 2021-12-13T21:02:18.823573-06:00</span></span>
<span><span class="co">## 4 gene_expression   4221504 2021-12-13T20:50:25.802750-06:00</span></span>
<span><span class="co">## 5 gene_expression   3828886 2021-12-13T21:02:08.938480-06:00</span></span>
<span><span class="co">## 6 gene_expression   2881690 2021-12-13T21:00:47.129504-06:00</span></span>
<span><span class="co">##                             md5sum                 updated_datetime</span></span>
<span><span class="co">## 1 bbf3056454389fe35837aae8f1d6ef61 2022-01-19T14:01:15.621847-06:00</span></span>
<span><span class="co">## 2 7a3053cd76efcf0a9681b7f0020f3bd1 2022-01-19T14:47:53.778421-06:00</span></span>
<span><span class="co">## 3 df64d2d93d1712dd882ffec54b90a0f8 2022-01-19T14:01:15.621847-06:00</span></span>
<span><span class="co">## 4 fc135a6076cc55d33370dcb2a0db0945 2022-01-19T14:47:45.329025-06:00</span></span>
<span><span class="co">## 5 0b8b2f1da115c2c1899b2924ab72ff27 2022-01-19T14:01:15.621847-06:00</span></span>
<span><span class="co">## 6 79ad7f463d3dafbea72d697f7b69d1d5 2022-01-19T14:01:15.621847-06:00</span></span>
<span><span class="co">##                                file_id                      data_type    state</span></span>
<span><span class="co">## 1 6431664a-4a19-4a02-8ea5-8478a295f391 Splice Junction Quantification released</span></span>
<span><span class="co">## 2 db02a2f2-2d83-4486-b8a3-3b01d6f0a6f2 Gene Expression Quantification released</span></span>
<span><span class="co">## 3 d1737bd6-98b5-4c83-977d-007123b554b2 Splice Junction Quantification released</span></span>
<span><span class="co">## 4 be11a1db-9919-47b8-bc06-90ce5f2c9b02 Gene Expression Quantification released</span></span>
<span><span class="co">## 5 49618db3-ba6f-442d-b001-6af64869461e Splice Junction Quantification released</span></span>
<span><span class="co">## 6 ffec2c19-e5f2-46c3-8fb7-02c620f06d8a Splice Junction Quantification released</span></span>
<span><span class="co">##   experimental_strategy</span></span>
<span><span class="co">## 1               RNA-Seq</span></span>
<span><span class="co">## 2               RNA-Seq</span></span>
<span><span class="co">## 3               RNA-Seq</span></span>
<span><span class="co">## 4               RNA-Seq</span></span>
<span><span class="co">## 5               RNA-Seq</span></span>
<span><span class="co">## 6               RNA-Seq</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="download-data">Download data<a class="anchor" aria-label="anchor" href="#download-data"></a>
</h3>
<p>After the 762 gene expression files specified in the query above. Using multiple processes to do the download very significantly speeds up the transfer in many cases. On a standard 1Gb connection, the following completes in about 30 seconds. The first time the data are downloaded, R will ask to create a cache directory (see <code><a href="../reference/gdc_cache.html">?gdc_cache</a></code> for details of setting and interacting with the cache). Resulting downloaded files will be stored in the cache directory. Future access to the same files will be directly from the cache, alleviating multiple downloads.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ge_manifest</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, <span class="va">gdcdata</span><span class="op">)</span></span></code></pre></div>
<p>If the download had included controlled-access data, the download above would have needed to include a <code>token</code>. Details are available in <a href="#authentication">the authentication section below</a>.</p>
</div>
<div class="section level3">
<h3 id="metadata-queries">Metadata queries<a class="anchor" aria-label="anchor" href="#metadata-queries"></a>
</h3>
<div class="section level4">
<h4 id="clinical-data">Clinical data<a class="anchor" aria-label="anchor" href="#clinical-data"></a>
</h4>
<p>Accessing clinical data is a very common task. Given a set of <code>case_ids</code>, the <code><a href="../reference/gdc_clinical.html">gdc_clinical()</a></code> function will return a list of four <code>tibble</code>s.</p>
<ul>
<li>demographic</li>
<li>diagnoses</li>
<li>exposures</li>
<li>main</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">case_ids</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/results.html">results</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/ids.html">ids</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">clindat</span> <span class="op">=</span> <span class="fu"><a href="../reference/gdc_clinical.html">gdc_clinical</a></span><span class="op">(</span><span class="va">case_ids</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">clindat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "demographic" "diagnoses"   "exposures"   "main"</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">clindat</span><span class="op">[[</span><span class="st">"main"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">##   id                               disea…¹ submi…² prima…³ updat…⁴ case_id state</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> b9a32a1c-9c93-5a92-8b30-e09a91d… Comple… TARGET… Kidney  2019-0… b9a32a… rele…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> c2829ab9-d5b2-5a82-a134-de9c591… Comple… TARGET… Kidney  2019-0… c2829a… rele…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> f5548317-3be4-5227-a655-dfb97e6… Comple… TARGET… Kidney  2019-0… f55483… rele…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> cf3bd8c5-4cd6-57c6-b07a-f20d414… Comple… TARGET… Kidney  2019-0… cf3bd8… rele…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> eaffceb7-3b14-5b19-a7f0-a43bd8c… Comple… TARGET… Kidney  2019-0… eaffce… rele…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> c07901d8-2829-5e98-9e8a-e12faaf… Comple… TARGET… Kidney  2019-0… c07901… rele…</span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable names ¹​disease_type, ²​submitter_id,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ³​primary_site, ⁴​updated_datetime</span></span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">clindat</span><span class="op">[[</span><span class="st">"diagnoses"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 19</span></span></span>
<span><span class="co">##   case_id    days_…¹ morph…² submi…³ created_datetime    last_…⁴ tissu…⁵ days_…⁶</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> b9a32a1c-… <span style="color: #BB0000;">NA</span>      8960/3  TARGET… 2017-02-25 <span style="color: #949494;">02:55:58</span> not re… Kidney…    <span style="text-decoration: underline;">3</span>828</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> c2829ab9-… <span style="color: #BB0000;">NA</span>      8960/3  TARGET… 2017-02-25 <span style="color: #949494;">02:57:38</span> not re… Kidney…    <span style="text-decoration: underline;">3</span>706</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> f5548317-… <span style="color: #BB0000;">NA</span>      8960/3  TARGET… 2017-02-25 <span style="color: #949494;">02:56:34</span> not re… Kidney…    <span style="text-decoration: underline;">2</span>717</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> cf3bd8c5-… <span style="color: #BB0000;">NA</span>      8960/3  TARGET… 2017-02-25 <span style="color: #949494;">02:55:01</span> not re… Kidney…    <span style="text-decoration: underline;">4</span>695</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> eaffceb7-… <span style="color: #BB0000;">NA</span>      8960/3  TARGET… 2017-02-25 <span style="color: #949494;">02:57:07</span> not re… Kidney…    <span style="text-decoration: underline;">3</span>954</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> c07901d8-… <span style="color: #BB0000;">NA</span>      8960/3  TARGET… 2017-02-25 <span style="color: #949494;">03:01:15</span> not re… Kidney…    <span style="text-decoration: underline;">1</span>918</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 11 more variables: age_at_diagnosis &lt;int&gt;, primary_diagnosis &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   updated_datetime &lt;dttm&gt;, diagnosis_id &lt;chr&gt;, year_of_diagnosis &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   cog_renal_stage &lt;chr&gt;, site_of_resection_or_biopsy &lt;chr&gt;, state &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   tumor_grade &lt;chr&gt;, days_to_last_known_disease_status &lt;lgl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   progression_or_recurrence &lt;chr&gt;, and abbreviated variable names</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ¹​days_to_recurrence, ²​morphology, ³​submitter_id,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ⁴​last_known_disease_status, ⁵​tissue_or_organ_of_origin, …</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="general-metadata-queries">General metadata queries<a class="anchor" aria-label="anchor" href="#general-metadata-queries"></a>
</h4>
<p>The <em><a href="https://bioconductor.org/packages/3.16/GenomicDataCommons" class="external-link">GenomicDataCommons</a></em> package can access the significant clinical, demographic, biospecimen, and annotation information contained in the NCI GDC. The <code><a href="../reference/gdc_clinical.html">gdc_clinical()</a></code> function will often be all that is needed, but the API and <em><a href="https://bioconductor.org/packages/3.16/GenomicDataCommons" class="external-link">GenomicDataCommons</a></em> package make much flexibility if fine-tuning is required.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expands</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diagnoses"</span>,<span class="st">"annotations"</span>,</span>
<span>             <span class="st">"demographic"</span>,<span class="st">"exposures"</span><span class="op">)</span></span>
<span><span class="va">clinResults</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/select.html">select</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/expand.html">expand</a></span><span class="op">(</span><span class="va">expands</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/results.html">results</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">clinResults</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,list.len<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  chr [1:50] "b9a32a1c-9c93-5a92-8b30-e09a91dc3cfc" ...</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># or listviewer::jsonedit(clinResults)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="basic-design">Basic design<a class="anchor" aria-label="anchor" href="#basic-design"></a>
</h2>
<p>This package design is meant to have some similarities to the “hadleyverse” approach of dplyr. Roughly, the functionality for finding and accessing files and metadata can be divided into:</p>
<ol style="list-style-type: decimal">
<li>Simple query constructors based on GDC API endpoints.</li>
<li>A set of verbs that when applied, adjust filtering, field selection, and faceting (fields for aggregation) and result in a new query object (an endomorphism)</li>
<li>A set of verbs that take a query and return results from the GDC</li>
</ol>
<p>In addition, there are exhiliary functions for asking the GDC API for information about available and default fields, slicing BAM files, and downloading actual data files. Here is an overview of functionality<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;See individual function and methods documentation for specific details.&lt;/p&gt;"><sup>1</sup></a>.</p>
<ul>
<li>Creating a query
<ul>
<li><code><a href="../reference/query.html">projects()</a></code></li>
<li><code><a href="../reference/query.html">cases()</a></code></li>
<li><code><a href="../reference/query.html">files()</a></code></li>
<li><code><a href="../reference/query.html">annotations()</a></code></li>
</ul>
</li>
<li>Manipulating a query
<ul>
<li><code><a href="../reference/filtering.html">filter()</a></code></li>
<li><code><a href="../reference/faceting.html">facet()</a></code></li>
<li><code><a href="../reference/select.html">select()</a></code></li>
</ul>
</li>
<li>Introspection on the GDC API fields
<ul>
<li><code><a href="../reference/mapping.html">mapping()</a></code></li>
<li><code><a href="../reference/available_fields.html">available_fields()</a></code></li>
<li><code><a href="../reference/default_fields.html">default_fields()</a></code></li>
<li><code><a href="../reference/grep_fields.html">grep_fields()</a></code></li>
<li><code><a href="../reference/available_values.html">available_values()</a></code></li>
<li><code><a href="../reference/available_expand.html">available_expand()</a></code></li>
</ul>
</li>
<li>Executing an API call to retrieve query results
<ul>
<li><code><a href="../reference/results.html">results()</a></code></li>
<li><code><a href="../reference/count.html">count()</a></code></li>
<li><code><a href="../reference/response.html">response()</a></code></li>
</ul>
</li>
<li>Raw data file downloads
<ul>
<li><code><a href="../reference/gdcdata.html">gdcdata()</a></code></li>
<li><code><a href="../reference/transfer.html">transfer()</a></code></li>
<li><code><a href="../reference/gdc_client.html">gdc_client()</a></code></li>
</ul>
</li>
<li>Summarizing and aggregating field values (faceting)
<ul>
<li><code><a href="../reference/aggregations.html">aggregations()</a></code></li>
</ul>
</li>
<li>Authentication
<ul>
<li><code><a href="../reference/gdc_token.html">gdc_token()</a></code></li>
</ul>
</li>
<li>BAM file slicing
<ul>
<li><code><a href="../reference/slicing.html">slicing()</a></code></li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>There are two main classes of operations when working with the NCI GDC.</p>
<ol style="list-style-type: decimal">
<li>
<a href="#querying-metadata">Querying metadata and finding data files</a> (e.g., finding all gene expression quantifications data files for all colon cancer patients).</li>
<li>
<a href="#datafile-access-and-download">Transferring raw or processed data</a> from the GDC to another computer (e.g., downloading raw or processed data)</li>
</ol>
<p>Both classes of operation are reviewed in detail in the following sections.</p>
<div class="section level3">
<h3 id="querying-metadata">Querying metadata<a class="anchor" aria-label="anchor" href="#querying-metadata"></a>
</h3>
<p>Vast amounts of metadata about cases (patients, basically), files, projects, and so-called annotations are available via the NCI GDC API. Typically, one will want to query metadata to either focus in on a set of files for download or transfer <em>or</em> to perform so-called aggregations (pivot-tables, facets, similar to the R <code><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table()</a></code> functionality).</p>
<p>Querying metadata starts with <a href="#creating-a-query">creating a “blank” query</a>. One will often then want to <a href="#filtering"><code>filter</code></a> the query to limit results prior to <a href="#retrieving-results">retrieving results</a>. The GenomicDataCommons package has <a href="#fields-and-values">helper functions for listing fields</a> that are available for filtering.</p>
<p>In addition to fetching results, the GDC API allows <a href="#facets-and-aggregation">faceting, or aggregating,</a>, useful for compiling reports, generating dashboards, or building user interfaces to GDC data (see GDC web query interface for a non-R-based example).</p>
<div class="section level4">
<h4 id="creating-a-query">Creating a query<a class="anchor" aria-label="anchor" href="#creating-a-query"></a>
</h4>
<p>A query of the GDC starts its life in R. Queries follow the four metadata endpoints available at the GDC. In particular, there are four convenience functions that each create <code>GDCQuery</code> objects (actually, specific subclasses of <code>GDCQuery</code>):</p>
<ul>
<li><code><a href="../reference/query.html">projects()</a></code></li>
<li><code><a href="../reference/query.html">cases()</a></code></li>
<li><code><a href="../reference/query.html">files()</a></code></li>
<li><code><a href="../reference/query.html">annotations()</a></code></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pquery</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">projects</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The <code>pquery</code> object is now an object of (S3) class, <code>GDCQuery</code> (and <code>gdc_projects</code> and <code>list</code>). The object contains the following elements:</p>
<ul>
<li>fields: This is a character vector of the fields that will be returned when we <a href="#retrieving-results">retrieve data</a>. If no fields are specified to, for example, the <code><a href="../reference/query.html">projects()</a></code> function, the default fields from the GDC are used (see <code><a href="../reference/default_fields.html">default_fields()</a></code>)</li>
<li>filters: This will contain results after calling the <a href="#filtering"><code>filter()</code> method</a> and will be used to filter results on <a href="#retrieving-results">retrieval</a>.</li>
<li>facets: A character vector of field names that will be used for <a href="#facets-and-aggregation">aggregating data</a> in a call to <code><a href="../reference/aggregations.html">aggregations()</a></code>.</li>
<li>archive: One of either “default” or <a href="https://gdc-portal.nci.nih.gov/legacy-archive/" class="external-link">“legacy”</a>.</li>
<li>token: A character(1) token from the GDC. See <a href="#authentication">the authentication section</a> for details, but note that, in general, the token is not necessary for metadata query and retrieval, only for actual data download.</li>
</ul>
<p>Looking at the actual object (get used to using <code><a href="https://rdrr.io/r/utils/str.html" class="external-link">str()</a></code>!), note that the query contains no results.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">pquery</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 5</span></span>
<span><span class="co">##  $ fields : chr [1:10] "dbgap_accession_number" "disease_type" "intended_release_date" "name" ...</span></span>
<span><span class="co">##  $ filters: NULL</span></span>
<span><span class="co">##  $ facets : NULL</span></span>
<span><span class="co">##  $ legacy : logi FALSE</span></span>
<span><span class="co">##  $ expand : NULL</span></span>
<span><span class="co">##  - attr(*, "class")= chr [1:3] "gdc_projects" "GDCQuery" "list"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="retrieving-results">Retrieving results<a class="anchor" aria-label="anchor" href="#retrieving-results"></a>
</h4>
<p><a href="https://docs.gdc.cancer.gov/API/Users_Guide/Search_and_Retrieval/#size-and-from" class="external-link">[ GDC pagination documentation ]</a></p>
<p><a href="https://docs.gdc.cancer.gov/API/Users_Guide/Search_and_Retrieval/#sort" class="external-link">[ GDC sorting documentation ]</a></p>
<p>With a query object available, the next step is to retrieve results from the GDC. The GenomicDataCommons package. The most basic type of results we can get is a simple <code><a href="../reference/count.html">count()</a></code> of records available that satisfy the filter criteria. Note that we have not set any filters, so a <code><a href="../reference/count.html">count()</a></code> here will represent all the project records publicly available at the GDC in the “default” archive"</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcount</span> <span class="op">=</span> <span class="fu"><a href="../reference/count.html">count</a></span><span class="op">(</span><span class="va">pquery</span><span class="op">)</span></span>
<span><span class="co"># or</span></span>
<span><span class="va">pcount</span> <span class="op">=</span> <span class="va">pquery</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pcount</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 72</span></span></code></pre>
<p>The <code><a href="../reference/results.html">results()</a></code> method will fetch actual results.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">presults</span> <span class="op">=</span> <span class="va">pquery</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/results.html">results</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>These results are returned from the GDC in <a href="http://www.json.org/" class="external-link">JSON</a> format and converted into a (potentially nested) list in R. The <code><a href="https://rdrr.io/r/utils/str.html" class="external-link">str()</a></code> method is useful for taking a quick glimpse of the data.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">presults</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 9</span></span>
<span><span class="co">##  $ id                    : chr [1:10] "TARGET-NBL" "GENIE-GRCC" "GENIE-DFCI" "GENIE-NKI" ...</span></span>
<span><span class="co">##  $ primary_site          :List of 10</span></span>
<span><span class="co">##   ..$ TARGET-NBL: chr [1:20] "Retroperitoneum and peritoneum" "Lymph nodes" "Stomach" "Connective, subcutaneous and other soft tissues" ...</span></span>
<span><span class="co">##   ..$ GENIE-GRCC: chr [1:45] "Other and ill-defined sites in lip, oral cavity and pharynx" "Uterus, NOS" "Rectum" "Ovary" ...</span></span>
<span><span class="co">##   ..$ GENIE-DFCI: chr [1:49] "Eye and adnexa" "Other and ill-defined sites in lip, oral cavity and pharynx" "Uterus, NOS" "Rectum" ...</span></span>
<span><span class="co">##   ..$ GENIE-NKI : chr [1:42] "Eye and adnexa" "Other and ill-defined sites in lip, oral cavity and pharynx" "Uterus, NOS" "Rectum" ...</span></span>
<span><span class="co">##   ..$ GENIE-VICC: chr [1:46] "Bronchus and lung" "Adrenal gland" "Gallbladder" "Esophagus" ...</span></span>
<span><span class="co">##   ..$ GENIE-UHN : chr [1:42] "Eye and adnexa" "Other and ill-defined sites in lip, oral cavity and pharynx" "Uterus, NOS" "Rectum" ...</span></span>
<span><span class="co">##   ..$ GENIE-MDA : chr [1:42] "Eye and adnexa" "Uterus, NOS" "Ovary" "Other and unspecified urinary organs" ...</span></span>
<span><span class="co">##   ..$ GENIE-MSK : chr [1:49] "Eye and adnexa" "Other and ill-defined sites in lip, oral cavity and pharynx" "Uterus, NOS" "Rectum" ...</span></span>
<span><span class="co">##   ..$ GENIE-JHU : chr [1:33] "Eye and adnexa" "Uterus, NOS" "Rectum" "Ovary" ...</span></span>
<span><span class="co">##   ..$ FM-AD     : chr [1:42] "Bronchus and lung" "Esophagus" "Cervix uteri" "Other and unspecified female genital organs" ...</span></span>
<span><span class="co">##  $ dbgap_accession_number: chr [1:10] "phs000467" NA NA NA ...</span></span>
<span><span class="co">##  $ project_id            : chr [1:10] "TARGET-NBL" "GENIE-GRCC" "GENIE-DFCI" "GENIE-NKI" ...</span></span>
<span><span class="co">##  $ disease_type          :List of 10</span></span>
<span><span class="co">##   ..$ TARGET-NBL: chr [1:2] "Neuroepitheliomatous Neoplasms" "Not Applicable"</span></span>
<span><span class="co">##   ..$ GENIE-GRCC: chr [1:32] "Osseous and Chondromatous Neoplasms" "Synovial-like Neoplasms" "Fibromatous Neoplasms" "Myomatous Neoplasms" ...</span></span>
<span><span class="co">##   ..$ GENIE-DFCI: chr [1:52] "Osseous and Chondromatous Neoplasms" "Other Leukemias" "Synovial-like Neoplasms" "Lymphoid Leukemias" ...</span></span>
<span><span class="co">##   ..$ GENIE-NKI : chr [1:23] "Synovial-like Neoplasms" "Fibromatous Neoplasms" "Myomatous Neoplasms" "Transitional Cell Papillomas and Carcinomas" ...</span></span>
<span><span class="co">##   ..$ GENIE-VICC: chr [1:43] "Neoplasms, NOS" "Adnexal and Skin Appendage Neoplasms" "Squamous Cell Neoplasms" "Gliomas" ...</span></span>
<span><span class="co">##   ..$ GENIE-UHN : chr [1:39] "Other Leukemias" "Osseous and Chondromatous Neoplasms" "Synovial-like Neoplasms" "Lymphoid Leukemias" ...</span></span>
<span><span class="co">##   ..$ GENIE-MDA : chr [1:34] "Osseous and Chondromatous Neoplasms" "Synovial-like Neoplasms" "Fibromatous Neoplasms" "Myomatous Neoplasms" ...</span></span>
<span><span class="co">##   ..$ GENIE-MSK : chr [1:49] "Osseous and Chondromatous Neoplasms" "Synovial-like Neoplasms" "Lymphoid Leukemias" "Fibromatous Neoplasms" ...</span></span>
<span><span class="co">##   ..$ GENIE-JHU : chr [1:33] "Osseous and Chondromatous Neoplasms" "Other Leukemias" "Synovial-like Neoplasms" "Lymphoid Leukemias" ...</span></span>
<span><span class="co">##   ..$ FM-AD     : chr [1:23] "Gliomas" "Acinar Cell Neoplasms" "Specialized Gonadal Neoplasms" "Miscellaneous Tumors" ...</span></span>
<span><span class="co">##  $ name                  : chr [1:10] "Neuroblastoma" "AACR Project GENIE - Contributed by Institut Gustave Roussy" "AACR Project GENIE - Contributed by Dana-Farber Cancer Institute" "AACR Project GENIE - Contributed by Netherlands Cancer Institute" ...</span></span>
<span><span class="co">##  $ releasable            : logi [1:10] TRUE TRUE TRUE TRUE TRUE TRUE ...</span></span>
<span><span class="co">##  $ state                 : chr [1:10] "open" "open" "open" "open" ...</span></span>
<span><span class="co">##  $ released              : logi [1:10] TRUE TRUE TRUE TRUE TRUE TRUE ...</span></span>
<span><span class="co">##  - attr(*, "row.names")= int [1:10] 1 2 3 4 5 6 7 8 9 10</span></span>
<span><span class="co">##  - attr(*, "class")= chr [1:3] "GDCprojectsResults" "GDCResults" "list"</span></span></code></pre>
<p>A default of only 10 records are returned. We can use the <code>size</code> and <code>from</code> arguments to <code><a href="../reference/results.html">results()</a></code> to either page through results or to change the number of results. Finally, there is a convenience method, <code><a href="../reference/results_all.html">results_all()</a></code> that will simply fetch all the available results given a query. Note that <code><a href="../reference/results_all.html">results_all()</a></code> may take a long time and return HUGE result sets if not used carefully. Use of a combination of <code><a href="../reference/count.html">count()</a></code> and <code><a href="../reference/results.html">results()</a></code> to get a sense of the expected data size is probably warranted before calling <code><a href="../reference/results_all.html">results_all()</a></code></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/ids.html">ids</a></span><span class="op">(</span><span class="va">presults</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 10</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">presults</span> <span class="op">=</span> <span class="va">pquery</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/results_all.html">results_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/ids.html">ids</a></span><span class="op">(</span><span class="va">presults</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 72</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># includes all records</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/ids.html">ids</a></span><span class="op">(</span><span class="va">presults</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="../reference/count.html">count</a></span><span class="op">(</span><span class="va">pquery</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Extracting subsets of results or manipulating the results into a more conventional R data structure is not easily generalizable. However, the <a href="https://github.com/hadley/purrr" class="external-link">purrr</a>, <a href="https://renkun.me/rlist/" class="external-link">rlist</a>, and <a href="https://cran.r-project.org/web/packages/data.tree/vignettes/data.tree.html" class="external-link">data.tree</a> packages are all potentially of interest for manipulating complex, nested list structures. For viewing the results in an interactive viewer, consider the <a href="https://github.com/timelyportfolio/listviewer" class="external-link">listviewer</a> package.</p>
</div>
<div class="section level4">
<h4 id="fields-and-values">Fields and Values<a class="anchor" aria-label="anchor" href="#fields-and-values"></a>
</h4>
<p><a href="https://docs.gdc.cancer.gov/API/Users_Guide/Search_and_Retrieval/#fields" class="external-link">[ GDC <code>fields</code> documentation ]</a></p>
<p>Central to querying and retrieving data from the GDC is the ability to specify which fields to return, filtering by fields and values, and faceting or aggregating. The GenomicDataCommons package includes two simple functions, <code><a href="../reference/available_fields.html">available_fields()</a></code> and <code><a href="../reference/default_fields.html">default_fields()</a></code>. Each can operate on a character(1) endpoint name (“cases”, “files”, “annotations”, or “projects”) or a <code>GDCQuery</code> object.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/default_fields.html">default_fields</a></span><span class="op">(</span><span class="st">'files'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "access"                         "acl"                           </span></span>
<span><span class="co">##  [3] "average_base_quality"           "average_insert_size"           </span></span>
<span><span class="co">##  [5] "average_read_length"            "channel"                       </span></span>
<span><span class="co">##  [7] "chip_id"                        "chip_position"                 </span></span>
<span><span class="co">##  [9] "contamination"                  "contamination_error"           </span></span>
<span><span class="co">## [11] "created_datetime"               "data_category"                 </span></span>
<span><span class="co">## [13] "data_format"                    "data_type"                     </span></span>
<span><span class="co">## [15] "error_type"                     "experimental_strategy"         </span></span>
<span><span class="co">## [17] "file_autocomplete"              "file_id"                       </span></span>
<span><span class="co">## [19] "file_name"                      "file_size"                     </span></span>
<span><span class="co">## [21] "imaging_date"                   "magnification"                 </span></span>
<span><span class="co">## [23] "md5sum"                         "mean_coverage"                 </span></span>
<span><span class="co">## [25] "msi_score"                      "msi_status"                    </span></span>
<span><span class="co">## [27] "pairs_on_diff_chr"              "plate_name"                    </span></span>
<span><span class="co">## [29] "plate_well"                     "platform"                      </span></span>
<span><span class="co">## [31] "proc_internal"                  "proportion_base_mismatch"      </span></span>
<span><span class="co">## [33] "proportion_coverage_10x"        "proportion_coverage_10X"       </span></span>
<span><span class="co">## [35] "proportion_coverage_30x"        "proportion_coverage_30X"       </span></span>
<span><span class="co">## [37] "proportion_reads_duplicated"    "proportion_reads_mapped"       </span></span>
<span><span class="co">## [39] "proportion_targets_no_coverage" "read_pair_number"              </span></span>
<span><span class="co">## [41] "revision"                       "stain_type"                    </span></span>
<span><span class="co">## [43] "state"                          "state_comment"                 </span></span>
<span><span class="co">## [45] "submitter_id"                   "tags"                          </span></span>
<span><span class="co">## [47] "total_reads"                    "tumor_ploidy"                  </span></span>
<span><span class="co">## [49] "tumor_purity"                   "type"                          </span></span>
<span><span class="co">## [51] "updated_datetime"</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The number of fields available for files endpoint</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/available_fields.html">available_fields</a></span><span class="op">(</span><span class="st">'files'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1017</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The first few fields available for files endpoint</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/available_fields.html">available_fields</a></span><span class="op">(</span><span class="st">'files'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "access"                      "acl"                        </span></span>
<span><span class="co">## [3] "analysis.analysis_id"        "analysis.analysis_type"     </span></span>
<span><span class="co">## [5] "analysis.created_datetime"   "analysis.input_files.access"</span></span></code></pre>
<p>The fields to be returned by a query can be specified following a similar paradigm to that of the dplyr package. The <code><a href="../reference/select.html">select()</a></code> function is a verb that resets the fields slot of a <code>GDCQuery</code>; note that this is not quite analogous to the dplyr <code><a href="../reference/select.html">select()</a></code> verb that limits from already-present fields. We <em>completely replace</em> the fields when using <code><a href="../reference/select.html">select()</a></code> on a <code>GDCQuery</code>.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Default fields here</span></span>
<span><span class="va">qcases</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">qcases</span><span class="op">$</span><span class="va">fields</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "aliquot_ids"              "analyte_ids"             </span></span>
<span><span class="co">##  [3] "case_autocomplete"        "case_id"                 </span></span>
<span><span class="co">##  [5] "consent_type"             "created_datetime"        </span></span>
<span><span class="co">##  [7] "days_to_consent"          "days_to_lost_to_followup"</span></span>
<span><span class="co">##  [9] "diagnosis_ids"            "disease_type"            </span></span>
<span><span class="co">## [11] "index_date"               "lost_to_followup"        </span></span>
<span><span class="co">## [13] "portion_ids"              "primary_site"            </span></span>
<span><span class="co">## [15] "sample_ids"               "slide_ids"               </span></span>
<span><span class="co">## [17] "state"                    "submitter_aliquot_ids"   </span></span>
<span><span class="co">## [19] "submitter_analyte_ids"    "submitter_diagnosis_ids" </span></span>
<span><span class="co">## [21] "submitter_id"             "submitter_portion_ids"   </span></span>
<span><span class="co">## [23] "submitter_sample_ids"     "submitter_slide_ids"     </span></span>
<span><span class="co">## [25] "updated_datetime"</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set up query to use ALL available fields</span></span>
<span><span class="co"># Note that checking of fields is done by select()</span></span>
<span><span class="va">qcases</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="../reference/available_fields.html">available_fields</a></span><span class="op">(</span><span class="st">'cases'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">qcases</span><span class="op">$</span><span class="va">fields</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "case_id"                       "aliquot_ids"                  </span></span>
<span><span class="co">## [3] "analyte_ids"                   "annotations.annotation_id"    </span></span>
<span><span class="co">## [5] "annotations.case_id"           "annotations.case_submitter_id"</span></span></code></pre>
<p>Finding fields of interest is such a common operation that the GenomicDataCommons includes the <code><a href="../reference/grep_fields.html">grep_fields()</a></code> function. See the appropriate help pages for details.</p>
</div>
<div class="section level4">
<h4 id="facets-and-aggregation">Facets and aggregation<a class="anchor" aria-label="anchor" href="#facets-and-aggregation"></a>
</h4>
<p><a href="https://docs.gdc.cancer.gov/API/Users_Guide/Search_and_Retrieval/#facets" class="external-link">[ GDC <code>facet</code> documentation ]</a></p>
<p>The GDC API offers a feature known as aggregation or faceting. By specifying one or more fields (of appropriate type), the GDC can return to us a count of the number of records matching each potential value. This is similar to the R <code>table</code> method. Multiple fields can be returned at once, but the GDC API does not have a cross-tabulation feature; all aggregations are only on one field at a time. Results of <code>aggregation()</code> calls come back as a list of data.frames (actually, tibbles).</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># total number of files of a specific type</span></span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">files</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/faceting.html">facet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'type'</span>,<span class="st">'data_type'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/aggregations.html">aggregations</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">type</span></span></code></pre></div>
<pre><code><span><span class="co">##    doc_count                           key</span></span>
<span><span class="co">## 1     190236    annotated_somatic_mutation</span></span>
<span><span class="co">## 2     123377                 aligned_reads</span></span>
<span><span class="co">## 3      86801          structural_variation</span></span>
<span><span class="co">## 4      86592       simple_somatic_mutation</span></span>
<span><span class="co">## 5      58883           copy_number_segment</span></span>
<span><span class="co">## 6      46153          copy_number_estimate</span></span>
<span><span class="co">## 7      43618               gene_expression</span></span>
<span><span class="co">## 8      33639   aggregated_somatic_mutation</span></span>
<span><span class="co">## 9      33234              mirna_expression</span></span>
<span><span class="co">## 10     31716      masked_methylation_array</span></span>
<span><span class="co">## 11     30075                   slide_image</span></span>
<span><span class="co">## 12     26002        biospecimen_supplement</span></span>
<span><span class="co">## 13     15858        methylation_beta_value</span></span>
<span><span class="co">## 14     15635       masked_somatic_mutation</span></span>
<span><span class="co">## 15     13135           clinical_supplement</span></span>
<span><span class="co">## 16      7906            protein_expression</span></span>
<span><span class="co">## 17        84 secondary_expression_analysis</span></span>
<span><span class="co">## 18        67              pathology_report</span></span></code></pre>
<p>Using <code><a href="../reference/aggregations.html">aggregations()</a></code> is an also easy way to learn the contents of individual fields and forms the basis for faceted search pages.</p>
</div>
<div class="section level4">
<h4 id="filtering">Filtering<a class="anchor" aria-label="anchor" href="#filtering"></a>
</h4>
<p><a href="https://docs.gdc.cancer.gov/API/Users_Guide/Search_and_Retrieval/#filters-specifying-the-query" class="external-link">[ GDC <code>filtering</code> documentation ]</a></p>
<p>The GenomicDataCommons package uses a form of non-standard evaluation to specify R-like queries that are then translated into an R list. That R list is, upon calling a method that fetches results from the GDC API, translated into the appropriate JSON string. The R expression uses the formula interface as suggested by Hadley Wickham in his <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/nse.html" class="external-link">vignette on non-standard evaluation</a></p>
<blockquote>
<p>It’s best to use a formula because a formula captures both the expression to evaluate and the environment where the evaluation occurs. This is important if the expression is a mixture of variables in a data frame and objects in the local environment [for example].</p>
</blockquote>
<p>For the user, these details will not be too important except to note that a filter expression must begin with a “~”.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qfiles</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">files</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">qfiles</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># all files</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 843011</span></span></code></pre>
<p>To limit the file type, we can refer back to the <a href="#facets-and-aggregation">section on faceting</a> to see the possible values for the file field “type”. For example, to filter file results to only “gene_expression” files, we simply specify a filter.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qfiles</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">files</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span> <span class="va">type</span> <span class="op">==</span> <span class="st">'gene_expression'</span><span class="op">)</span></span>
<span><span class="co"># here is what the filter looks like after translation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/filtering.html">get_filter</a></span><span class="op">(</span><span class="va">qfiles</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 2</span></span>
<span><span class="co">##  $ op     : 'scalar' chr "="</span></span>
<span><span class="co">##  $ content:List of 2</span></span>
<span><span class="co">##   ..$ field: chr "type"</span></span>
<span><span class="co">##   ..$ value: chr "gene_expression"</span></span></code></pre>
<p>What if we want to create a filter based on the project (‘TCGA-OVCA’, for example)? Well, we have a couple of possible ways to discover available fields. The first is based on base R functionality and some intuition.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">'pro'</span>,<span class="fu"><a href="../reference/available_fields.html">available_fields</a></span><span class="op">(</span><span class="st">'files'</span><span class="op">)</span>,value<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "analysis.input_files.proc_internal"           </span></span>
<span><span class="co">## [2] "analysis.input_files.proportion_base_mismatch"</span></span>
<span><span class="co">## [3] "analysis.input_files.proportion_coverage_10x" </span></span>
<span><span class="co">## [4] "analysis.input_files.proportion_coverage_10X" </span></span>
<span><span class="co">## [5] "analysis.input_files.proportion_coverage_30x" </span></span>
<span><span class="co">## [6] "analysis.input_files.proportion_coverage_30X"</span></span></code></pre>
<p>Interestingly, the project information is “nested” inside the case. We don’t need to know that detail other than to know that we now have a few potential guesses for where our information might be in the files records. We need to know where because we need to construct the appropriate filter.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/query.html">files</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/faceting.html">facet</a></span><span class="op">(</span><span class="st">'cases.project.project_id'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/aggregations.html">aggregations</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $cases.project.project_id</span></span>
<span><span class="co">##    doc_count                       key</span></span>
<span><span class="co">## 1      54096                     FM-AD</span></span>
<span><span class="co">## 2      49455                 TCGA-BRCA</span></span>
<span><span class="co">## 3      56636                   CPTAC-3</span></span>
<span><span class="co">## 4      38305                TARGET-AML</span></span>
<span><span class="co">## 5      26469                 TCGA-LUAD</span></span>
<span><span class="co">## 6      36470                 GENIE-MSK</span></span>
<span><span class="co">## 7      22749                 TCGA-UCEC</span></span>
<span><span class="co">## 8      23663                 TCGA-HNSC</span></span>
<span><span class="co">## 9      22838                 TCGA-THCA</span></span>
<span><span class="co">## 10     23734                 TCGA-KIRC</span></span>
<span><span class="co">## 11     21971                   TCGA-OV</span></span>
<span><span class="co">## 12     23893                 TCGA-LUSC</span></span>
<span><span class="co">## 13     23134                  TCGA-LGG</span></span>
<span><span class="co">## 14     22531                 TCGA-PRAD</span></span>
<span><span class="co">## 15     20776                 TCGA-COAD</span></span>
<span><span class="co">## 16     18013                  TCGA-GBM</span></span>
<span><span class="co">## 17     28464                GENIE-DFCI</span></span>
<span><span class="co">## 18     20167                 TCGA-SKCM</span></span>
<span><span class="co">## 19     19694                 TCGA-STAD</span></span>
<span><span class="co">## 20     27014             MMRF-COMMPASS</span></span>
<span><span class="co">## 21     18331                 TCGA-BLCA</span></span>
<span><span class="co">## 22     16965                 TCGA-LIHC</span></span>
<span><span class="co">## 23     16959             TARGET-ALL-P2</span></span>
<span><span class="co">## 24     13339                 TCGA-CESC</span></span>
<span><span class="co">## 25     13387                 TCGA-KIRP</span></span>
<span><span class="co">## 26     11593                 TCGA-SARC</span></span>
<span><span class="co">## 27     14968         BEATAML1.0-COHORT</span></span>
<span><span class="co">## 28     11553                 REBC-THYR</span></span>
<span><span class="co">## 29      8187                 TCGA-PAAD</span></span>
<span><span class="co">## 30      8164                 TCGA-ESCA</span></span>
<span><span class="co">## 31      7868                 TCGA-PCPG</span></span>
<span><span class="co">## 32      7178                 TCGA-READ</span></span>
<span><span class="co">## 33      6731                 TCGA-TGCT</span></span>
<span><span class="co">## 34      9244                   CPTAC-2</span></span>
<span><span class="co">## 35      5358                TARGET-NBL</span></span>
<span><span class="co">## 36      7221                 TCGA-LAML</span></span>
<span><span class="co">## 37      5376                 TCGA-THYM</span></span>
<span><span class="co">## 38      6984                 HCMI-CMDC</span></span>
<span><span class="co">## 39      5304             CGCI-HTMCP-CC</span></span>
<span><span class="co">## 40      5454                   CMI-MBC</span></span>
<span><span class="co">## 41      3876                  TCGA-ACC</span></span>
<span><span class="co">## 42      3493                 TCGA-KICH</span></span>
<span><span class="co">## 43      5286              NCICCR-DLBCL</span></span>
<span><span class="co">## 44      3666                 TCGA-MESO</span></span>
<span><span class="co">## 45      3383                  TCGA-UVM</span></span>
<span><span class="co">## 46      2532                 TARGET-WT</span></span>
<span><span class="co">## 47      2801                 TARGET-OS</span></span>
<span><span class="co">## 48      3625             TARGET-ALL-P3</span></span>
<span><span class="co">## 49      3857                 GENIE-MDA</span></span>
<span><span class="co">## 50      3833                GENIE-VICC</span></span>
<span><span class="co">## 51      2549                  TCGA-UCS</span></span>
<span><span class="co">## 52      3320                 GENIE-JHU</span></span>
<span><span class="co">## 53      2043                 TCGA-DLBC</span></span>
<span><span class="co">## 54      2059                 TCGA-CHOL</span></span>
<span><span class="co">## 55      2632                 GENIE-UHN</span></span>
<span><span class="co">## 56      2139                CGCI-BLGSP</span></span>
<span><span class="co">## 57      1826 EXCEPTIONAL_RESPONDERS-ER</span></span>
<span><span class="co">## 58      1571                 MP2PRT-WT</span></span>
<span><span class="co">## 59      1036                 TARGET-RT</span></span>
<span><span class="co">## 60      1093                WCDT-MCRPC</span></span>
<span><span class="co">## 61      1038                GENIE-GRCC</span></span>
<span><span class="co">## 62       878                  OHSU-CNL</span></span>
<span><span class="co">## 63       806                   CMI-ASC</span></span>
<span><span class="co">## 64       801                 GENIE-NKI</span></span>
<span><span class="co">## 65       758       ORGANOID-PANCREATIC</span></span>
<span><span class="co">## 66       553               CTSP-DLBCL1</span></span>
<span><span class="co">## 67       480                   CMI-MPC</span></span>
<span><span class="co">## 68       339                  TRIO-CRU</span></span>
<span><span class="co">## 69       222     BEATAML1.0-CRENOLANIB</span></span>
<span><span class="co">## 70       163               TARGET-CCSK</span></span>
<span><span class="co">## 71        96             TARGET-ALL-P1</span></span>
<span><span class="co">## 72        21            VAREPOP-APOLLO</span></span></code></pre>
<p>We note that <code>cases.project.project_id</code> looks like it is a good fit. We also note that <code>TCGA-OV</code> is the correct project_id, not <code>TCGA-OVCA</code>. Note that <em>unlike with dplyr and friends, the <code><a href="../reference/filtering.html">filter()</a></code> method here <strong>replaces</strong> the filter and does not build on any previous filters</em>.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qfiles</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">files</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span> <span class="va">cases.project.project_id</span> <span class="op">==</span> <span class="st">'TCGA-OV'</span> <span class="op">&amp;</span> <span class="va">type</span> <span class="op">==</span> <span class="st">'gene_expression'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/filtering.html">get_filter</a></span><span class="op">(</span><span class="va">qfiles</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 2</span></span>
<span><span class="co">##  $ op     : 'scalar' chr "and"</span></span>
<span><span class="co">##  $ content:List of 2</span></span>
<span><span class="co">##   ..$ :List of 2</span></span>
<span><span class="co">##   .. ..$ op     : 'scalar' chr "="</span></span>
<span><span class="co">##   .. ..$ content:List of 2</span></span>
<span><span class="co">##   .. .. ..$ field: chr "cases.project.project_id"</span></span>
<span><span class="co">##   .. .. ..$ value: chr "TCGA-OV"</span></span>
<span><span class="co">##   ..$ :List of 2</span></span>
<span><span class="co">##   .. ..$ op     : 'scalar' chr "="</span></span>
<span><span class="co">##   .. ..$ content:List of 2</span></span>
<span><span class="co">##   .. .. ..$ field: chr "type"</span></span>
<span><span class="co">##   .. .. ..$ value: chr "gene_expression"</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qfiles</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 762</span></span></code></pre>
<p>Asking for a <code><a href="../reference/count.html">count()</a></code> of results given these new filter criteria gives <code>r qfiles %&gt;% count()</code> results. Filters can be chained (or nested) to accomplish the same effect as multiple <code>&amp;</code> conditionals. The <code><a href="../reference/count.html">count()</a></code> below is equivalent to the <code>&amp;</code> filtering done above.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qfiles2</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">files</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span> <span class="va">cases.project.project_id</span> <span class="op">==</span> <span class="st">'TCGA-OV'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span> <span class="va">type</span> <span class="op">==</span> <span class="st">'gene_expression'</span><span class="op">)</span> </span>
<span><span class="va">qfiles2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 762</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">qfiles</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="op">(</span><span class="va">qfiles2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co">#TRUE</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Generating a manifest for bulk downloads is as simple as asking for the manifest from the current query.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">manifest_df</span> <span class="op">=</span> <span class="va">qfiles</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/manifest.html">manifest</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">manifest_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                     id data_format     access</span></span>
<span><span class="co">## 1 6431664a-4a19-4a02-8ea5-8478a295f391         TSV controlled</span></span>
<span><span class="co">## 2 db02a2f2-2d83-4486-b8a3-3b01d6f0a6f2         TSV       open</span></span>
<span><span class="co">## 3 d1737bd6-98b5-4c83-977d-007123b554b2         TSV controlled</span></span>
<span><span class="co">## 4 be11a1db-9919-47b8-bc06-90ce5f2c9b02         TSV       open</span></span>
<span><span class="co">## 5 49618db3-ba6f-442d-b001-6af64869461e         TSV controlled</span></span>
<span><span class="co">## 6 ffec2c19-e5f2-46c3-8fb7-02c620f06d8a         TSV controlled</span></span>
<span><span class="co">##                                                                     file_name</span></span>
<span><span class="co">## 1   2fb7ad5a-0ef2-4524-9fa8-4d61d1bb04e1.rna_seq.star_splice_junctions.tsv.gz</span></span>
<span><span class="co">## 2 2fb7ad5a-0ef2-4524-9fa8-4d61d1bb04e1.rna_seq.augmented_star_gene_counts.tsv</span></span>
<span><span class="co">## 3   8a7a4704-c698-4291-ba48-207895898a40.rna_seq.star_splice_junctions.tsv.gz</span></span>
<span><span class="co">## 4 8a7a4704-c698-4291-ba48-207895898a40.rna_seq.augmented_star_gene_counts.tsv</span></span>
<span><span class="co">## 5   872f7c22-17e4-4940-809b-a0970fde369b.rna_seq.star_splice_junctions.tsv.gz</span></span>
<span><span class="co">## 6   6ab54953-3d77-4239-bf4a-5a893cf9a43c.rna_seq.star_splice_junctions.tsv.gz</span></span>
<span><span class="co">##                           submitter_id           data_category       acl</span></span>
<span><span class="co">## 1 1fe77c9d-4a01-4de1-8217-d0a329800e60 Transcriptome Profiling phs000178</span></span>
<span><span class="co">## 2 16328313-f0d8-462d-a02b-5a6f2f4feabf Transcriptome Profiling      open</span></span>
<span><span class="co">## 3 047ec964-cda2-4932-a979-29ef0e5b109d Transcriptome Profiling phs000178</span></span>
<span><span class="co">## 4 8b20ea0f-57d5-420a-839d-03e9235a9536 Transcriptome Profiling      open</span></span>
<span><span class="co">## 5 836530f2-4019-42df-8b39-25f53a875350 Transcriptome Profiling phs000178</span></span>
<span><span class="co">## 6 8ff29681-9fc8-44a7-a7d1-fa11da07d81f Transcriptome Profiling phs000178</span></span>
<span><span class="co">##              type file_size                 created_datetime</span></span>
<span><span class="co">## 1 gene_expression   2800561 2021-12-13T20:58:10.452132-06:00</span></span>
<span><span class="co">## 2 gene_expression   4230648 2021-12-13T20:46:42.020696-06:00</span></span>
<span><span class="co">## 3 gene_expression   2538631 2021-12-13T21:02:18.823573-06:00</span></span>
<span><span class="co">## 4 gene_expression   4221504 2021-12-13T20:50:25.802750-06:00</span></span>
<span><span class="co">## 5 gene_expression   3828886 2021-12-13T21:02:08.938480-06:00</span></span>
<span><span class="co">## 6 gene_expression   2881690 2021-12-13T21:00:47.129504-06:00</span></span>
<span><span class="co">##                             md5sum                 updated_datetime</span></span>
<span><span class="co">## 1 bbf3056454389fe35837aae8f1d6ef61 2022-01-19T14:01:15.621847-06:00</span></span>
<span><span class="co">## 2 7a3053cd76efcf0a9681b7f0020f3bd1 2022-01-19T14:47:53.778421-06:00</span></span>
<span><span class="co">## 3 df64d2d93d1712dd882ffec54b90a0f8 2022-01-19T14:01:15.621847-06:00</span></span>
<span><span class="co">## 4 fc135a6076cc55d33370dcb2a0db0945 2022-01-19T14:47:45.329025-06:00</span></span>
<span><span class="co">## 5 0b8b2f1da115c2c1899b2924ab72ff27 2022-01-19T14:01:15.621847-06:00</span></span>
<span><span class="co">## 6 79ad7f463d3dafbea72d697f7b69d1d5 2022-01-19T14:01:15.621847-06:00</span></span>
<span><span class="co">##                                file_id                      data_type    state</span></span>
<span><span class="co">## 1 6431664a-4a19-4a02-8ea5-8478a295f391 Splice Junction Quantification released</span></span>
<span><span class="co">## 2 db02a2f2-2d83-4486-b8a3-3b01d6f0a6f2 Gene Expression Quantification released</span></span>
<span><span class="co">## 3 d1737bd6-98b5-4c83-977d-007123b554b2 Splice Junction Quantification released</span></span>
<span><span class="co">## 4 be11a1db-9919-47b8-bc06-90ce5f2c9b02 Gene Expression Quantification released</span></span>
<span><span class="co">## 5 49618db3-ba6f-442d-b001-6af64869461e Splice Junction Quantification released</span></span>
<span><span class="co">## 6 ffec2c19-e5f2-46c3-8fb7-02c620f06d8a Splice Junction Quantification released</span></span>
<span><span class="co">##   experimental_strategy</span></span>
<span><span class="co">## 1               RNA-Seq</span></span>
<span><span class="co">## 2               RNA-Seq</span></span>
<span><span class="co">## 3               RNA-Seq</span></span>
<span><span class="co">## 4               RNA-Seq</span></span>
<span><span class="co">## 5               RNA-Seq</span></span>
<span><span class="co">## 6               RNA-Seq</span></span></code></pre>
<p>Note that we might still not be quite there. Looking at filenames, there are suspiciously named files that might include “FPKM”, “FPKM-UQ”, or “counts”. Another round of <code>grep</code> and <code>available_fields</code>, looking for “type” turned up that the field “analysis.workflow_type” has the appropriate filter criteria.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qfiles</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">files</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">cases.project.project_id</span> <span class="op">==</span> <span class="st">'TCGA-OV'</span> <span class="op">&amp;</span></span>
<span>                            <span class="va">type</span> <span class="op">==</span> <span class="st">'gene_expression'</span> <span class="op">&amp;</span></span>
<span>                            <span class="va">access</span> <span class="op">==</span> <span class="st">"open"</span> <span class="op">&amp;</span></span>
<span>                            <span class="va">analysis.workflow_type</span> <span class="op">==</span> <span class="st">'STAR - Counts'</span><span class="op">)</span></span>
<span><span class="va">manifest_df</span> <span class="op">=</span> <span class="va">qfiles</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/manifest.html">manifest</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">manifest_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 381</span></span></code></pre>
<p>The GDC Data Transfer Tool can be used (from R, <code><a href="../reference/transfer.html">transfer()</a></code> or from the command-line) to orchestrate high-performance, restartable transfers of all the files in the manifest. See <a href="bulk-downloads">the bulk downloads section</a> for details.</p>
</div>
</div>
<div class="section level3">
<h3 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h3>
<p><a href="https://docs.gdc.cancer.gov/API/Users_Guide/Search_and_Retrieval/#facets" class="external-link">[ GDC authentication documentation ]</a></p>
<p>The GDC offers both “controlled-access” and “open” data. As of this writing, only data stored as files is “controlled-access”; that is, metadata accessible via the GDC is all “open” data and some files are “open” and some are “controlled-access”. Controlled-access data are only available after <a href="https://gdc.cancer.gov/access-data/obtaining-access-controlled-data" class="external-link">going through the process of obtaining access.</a></p>
<p>After controlled-access to one or more datasets has been granted, logging into the GDC web portal will allow you to <a href="https://docs.gdc.cancer.gov/Data_Portal/Users_Guide/Authentication/#gdc-authentication-tokens" class="external-link">access a GDC authentication token</a>, which can be downloaded and then used to access available controlled-access data via the GenomicDataCommons package.</p>
<p>The GenomicDataCommons uses authentication tokens only for downloading data (see <code>transfer</code> and <code>gdcdata</code> documentation). The package includes a helper function, <code>gdc_token</code>, that looks for the token to be stored in one of three ways (resolved in this order):</p>
<ol style="list-style-type: decimal">
<li>As a string stored in the environment variable, <code>GDC_TOKEN</code>
</li>
<li>As a file, stored in the file named by the environment variable, <code>GDC_TOKEN_FILE</code>
</li>
<li>In a file in the user home directory, called <code>.gdc_token</code>
</li>
</ol>
<p>As a concrete example:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">token</span> <span class="op">=</span> <span class="fu"><a href="../reference/gdc_token.html">gdc_token</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/transfer.html">transfer</a></span><span class="op">(</span><span class="va">...</span>,token<span class="op">=</span><span class="va">token</span><span class="op">)</span></span>
<span><span class="co"># or</span></span>
<span><span class="fu"><a href="../reference/transfer.html">transfer</a></span><span class="op">(</span><span class="va">...</span>,token<span class="op">=</span><span class="fu">get_token</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="datafile-access-and-download">Datafile access and download<a class="anchor" aria-label="anchor" href="#datafile-access-and-download"></a>
</h3>
<div class="section level4">
<h4 id="data-downloads-via-the-gdc-api">Data downloads via the GDC API<a class="anchor" aria-label="anchor" href="#data-downloads-via-the-gdc-api"></a>
</h4>
<p>The <code>gdcdata</code> function takes a character vector of one or more file ids. A simple way of producing such a vector is to produce a <code>manifest</code> data frame and then pass in the first column, which will contain file ids.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fnames</span> <span class="op">=</span> <span class="fu"><a href="../reference/gdcdata.html">gdcdata</a></span><span class="op">(</span><span class="va">manifest_df</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,progress<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Note that for controlled-access data, a GDC <a href="#authentication">authentication token</a> is required. Using the <code>BiocParallel</code> package may be useful for downloading in parallel, particularly for large numbers of smallish files.</p>
</div>
<div class="section level4">
<h4 id="bulk-downloads">Bulk downloads<a class="anchor" aria-label="anchor" href="#bulk-downloads"></a>
</h4>
<p>The bulk download functionality is only efficient (as of v1.2.0 of the GDC Data Transfer Tool) for relatively large files, so use this approach only when transferring BAM files or larger VCF files, for example. Otherwise, consider using the approach shown above, perhaps in parallel.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Requires gcd_client command-line utility to be isntalled</span></span>
<span><span class="co"># separately. </span></span>
<span><span class="va">fnames</span> <span class="op">=</span> <span class="fu"><a href="../reference/gdcdata.html">gdcdata</a></span><span class="op">(</span><span class="va">manifest_df</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, access_method <span class="op">=</span> <span class="st">'client'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="bam-slicing">BAM slicing<a class="anchor" aria-label="anchor" href="#bam-slicing"></a>
</h4>
</div>
</div>
</div>
<div class="section level2">
<h2 id="use-cases">Use Cases<a class="anchor" aria-label="anchor" href="#use-cases"></a>
</h2>
<div class="section level3">
<h3 id="cases">Cases<a class="anchor" aria-label="anchor" href="#cases"></a>
</h3>
<div class="section level4">
<h4 id="how-many-cases-are-there-per-project_id">How many cases are there per project_id?<a class="anchor" aria-label="anchor" href="#how-many-cases-are-there-per-project_id"></a>
</h4>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/faceting.html">facet</a></span><span class="op">(</span><span class="st">"project.project_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/aggregations.html">aggregations</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $project.project_id</span></span>
<span><span class="co">##    doc_count                       key</span></span>
<span><span class="co">## 1      18004                     FM-AD</span></span>
<span><span class="co">## 2      16824                 GENIE-MSK</span></span>
<span><span class="co">## 3      14232                GENIE-DFCI</span></span>
<span><span class="co">## 4       3857                 GENIE-MDA</span></span>
<span><span class="co">## 5       3320                 GENIE-JHU</span></span>
<span><span class="co">## 6       2632                 GENIE-UHN</span></span>
<span><span class="co">## 7       2492                TARGET-AML</span></span>
<span><span class="co">## 8       2052                GENIE-VICC</span></span>
<span><span class="co">## 9       1587             TARGET-ALL-P2</span></span>
<span><span class="co">## 10      1132                TARGET-NBL</span></span>
<span><span class="co">## 11      1098                 TCGA-BRCA</span></span>
<span><span class="co">## 12      1046                   CPTAC-3</span></span>
<span><span class="co">## 13      1038                GENIE-GRCC</span></span>
<span><span class="co">## 14       995             MMRF-COMMPASS</span></span>
<span><span class="co">## 15       826         BEATAML1.0-COHORT</span></span>
<span><span class="co">## 16       801                 GENIE-NKI</span></span>
<span><span class="co">## 17       652                 TARGET-WT</span></span>
<span><span class="co">## 18       617                  TCGA-GBM</span></span>
<span><span class="co">## 19       608                   TCGA-OV</span></span>
<span><span class="co">## 20       585                 TCGA-LUAD</span></span>
<span><span class="co">## 21       560                 TCGA-UCEC</span></span>
<span><span class="co">## 22       537                 TCGA-KIRC</span></span>
<span><span class="co">## 23       528                 TCGA-HNSC</span></span>
<span><span class="co">## 24       516                  TCGA-LGG</span></span>
<span><span class="co">## 25       507                 TCGA-THCA</span></span>
<span><span class="co">## 26       504                 TCGA-LUSC</span></span>
<span><span class="co">## 27       500                 TCGA-PRAD</span></span>
<span><span class="co">## 28       489              NCICCR-DLBCL</span></span>
<span><span class="co">## 29       470                 TCGA-SKCM</span></span>
<span><span class="co">## 30       461                 TCGA-COAD</span></span>
<span><span class="co">## 31       443                 TCGA-STAD</span></span>
<span><span class="co">## 32       440                 REBC-THYR</span></span>
<span><span class="co">## 33       412                 TCGA-BLCA</span></span>
<span><span class="co">## 34       383                 TARGET-OS</span></span>
<span><span class="co">## 35       377                 TCGA-LIHC</span></span>
<span><span class="co">## 36       342                   CPTAC-2</span></span>
<span><span class="co">## 37       339                  TRIO-CRU</span></span>
<span><span class="co">## 38       307                 TCGA-CESC</span></span>
<span><span class="co">## 39       291                 TCGA-KIRP</span></span>
<span><span class="co">## 40       261                 TCGA-SARC</span></span>
<span><span class="co">## 41       212             CGCI-HTMCP-CC</span></span>
<span><span class="co">## 42       200                   CMI-MBC</span></span>
<span><span class="co">## 43       200                 TCGA-LAML</span></span>
<span><span class="co">## 44       191             TARGET-ALL-P3</span></span>
<span><span class="co">## 45       185                 TCGA-ESCA</span></span>
<span><span class="co">## 46       185                 TCGA-PAAD</span></span>
<span><span class="co">## 47       179                 TCGA-PCPG</span></span>
<span><span class="co">## 48       176                  OHSU-CNL</span></span>
<span><span class="co">## 49       172                 TCGA-READ</span></span>
<span><span class="co">## 50       150                 TCGA-TGCT</span></span>
<span><span class="co">## 51       124                 TCGA-THYM</span></span>
<span><span class="co">## 52       120                CGCI-BLGSP</span></span>
<span><span class="co">## 53       113                 TCGA-KICH</span></span>
<span><span class="co">## 54       110                 HCMI-CMDC</span></span>
<span><span class="co">## 55       101                WCDT-MCRPC</span></span>
<span><span class="co">## 56        92                  TCGA-ACC</span></span>
<span><span class="co">## 57        87                 TCGA-MESO</span></span>
<span><span class="co">## 58        84 EXCEPTIONAL_RESPONDERS-ER</span></span>
<span><span class="co">## 59        80                  TCGA-UVM</span></span>
<span><span class="co">## 60        70       ORGANOID-PANCREATIC</span></span>
<span><span class="co">## 61        69                 TARGET-RT</span></span>
<span><span class="co">## 62        58                 TCGA-DLBC</span></span>
<span><span class="co">## 63        57                  TCGA-UCS</span></span>
<span><span class="co">## 64        56     BEATAML1.0-CRENOLANIB</span></span>
<span><span class="co">## 65        52                 MP2PRT-WT</span></span>
<span><span class="co">## 66        51                 TCGA-CHOL</span></span>
<span><span class="co">## 67        45               CTSP-DLBCL1</span></span>
<span><span class="co">## 68        36                   CMI-ASC</span></span>
<span><span class="co">## 69        30                   CMI-MPC</span></span>
<span><span class="co">## 70        24             TARGET-ALL-P1</span></span>
<span><span class="co">## 71        13               TARGET-CCSK</span></span>
<span><span class="co">## 72         7            VAREPOP-APOLLO</span></span></code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">project.project_id</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">key</span>, y <span class="op">=</span> <span class="va">doc_count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'identity'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="overview_files/figure-html/casesPerProject-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="how-many-cases-are-included-in-all-target-projects">How many cases are included in all TARGET projects?<a class="anchor" aria-label="anchor" href="#how-many-cases-are-included-in-all-target-projects"></a>
</h4>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span><span class="op">~</span> <span class="va">project.program.name</span><span class="op">==</span><span class="st">'TARGET'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6543</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="how-many-cases-are-included-in-all-tcga-projects">How many cases are included in all TCGA projects?<a class="anchor" aria-label="anchor" href="#how-many-cases-are-included-in-all-tcga-projects"></a>
</h4>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span><span class="op">~</span> <span class="va">project.program.name</span><span class="op">==</span><span class="st">'TCGA'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 11315</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="what-is-the-breakdown-of-sample-types-in-tcga-brca">What is the breakdown of sample types in TCGA-BRCA?<a class="anchor" aria-label="anchor" href="#what-is-the-breakdown-of-sample-types-in-tcga-brca"></a>
</h4>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The need to do the "&amp;" here is a requirement of the</span></span>
<span><span class="co"># current version of the GDC API. I have filed a feature</span></span>
<span><span class="co"># request to remove this requirement.</span></span>
<span><span class="va">resp</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span><span class="op">~</span> <span class="va">project.project_id</span><span class="op">==</span><span class="st">'TCGA-BRCA'</span> <span class="op">&amp;</span></span>
<span>                              <span class="va">project.project_id</span><span class="op">==</span><span class="st">'TCGA-BRCA'</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/faceting.html">facet</a></span><span class="op">(</span><span class="st">'samples.sample_type'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/aggregations.html">aggregations</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">resp</span><span class="op">$</span><span class="va">samples.sample_type</span></span></code></pre></div>
<pre><code><span><span class="co">##   doc_count                  key</span></span>
<span><span class="co">## 1      1098        primary tumor</span></span>
<span><span class="co">## 2      1011 blood derived normal</span></span>
<span><span class="co">## 3       162  solid tissue normal</span></span>
<span><span class="co">## 4         7           metastatic</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="fetch-all-samples-in-tcga-brca-that-use-solid-tissue-as-a-normal-">Fetch all samples in TCGA-BRCA that use “Solid Tissue” as a normal.<a class="anchor" aria-label="anchor" href="#fetch-all-samples-in-tcga-brca-that-use-solid-tissue-as-a-normal-"></a>
</h4>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The need to do the "&amp;" here is a requirement of the</span></span>
<span><span class="co"># current version of the GDC API. I have filed a feature</span></span>
<span><span class="co"># request to remove this requirement.</span></span>
<span><span class="va">resp</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span><span class="op">~</span> <span class="va">project.project_id</span><span class="op">==</span><span class="st">'TCGA-BRCA'</span> <span class="op">&amp;</span></span>
<span>                              <span class="va">samples.sample_type</span><span class="op">==</span><span class="st">'Solid Tissue Normal'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/default_fields.html">default_fields</a></span><span class="op">(</span><span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,<span class="st">'samples.sample_type'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/response.html">response_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/count.html">count</a></span><span class="op">(</span><span class="va">resp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 162</span></span></code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> <span class="va">resp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/results.html">results</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,list.len<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 1</span></span>
<span><span class="co">##  $ id: chr [1:162] "3d676bba-154b-4d22-ab59-d4d4da051b94" "1133b8a9-6b11-4511-b70a-f200e3b8b5db" "17c1d42c-cb84-4655-a4cd-b54bae17ecaf" "9da462b0-93c2-4305-89f6-7199a30399a7" ...</span></span></code></pre>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/ids.html">ids</a></span><span class="op">(</span><span class="va">resp</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "3d676bba-154b-4d22-ab59-d4d4da051b94"</span></span>
<span><span class="co">## [2] "1133b8a9-6b11-4511-b70a-f200e3b8b5db"</span></span>
<span><span class="co">## [3] "17c1d42c-cb84-4655-a4cd-b54bae17ecaf"</span></span>
<span><span class="co">## [4] "9da462b0-93c2-4305-89f6-7199a30399a7"</span></span>
<span><span class="co">## [5] "14267783-5624-4fe5-ba81-9d67f1017474"</span></span>
<span><span class="co">## [6] "26573441-eedb-4364-966c-e7f803deef19"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="get-all-tcga-case-ids-that-are-female">Get all TCGA case ids that are female<a class="anchor" aria-label="anchor" href="#get-all-tcga-case-ids-that-are-female"></a>
</h4>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span><span class="op">~</span> <span class="va">project.program.name</span> <span class="op">==</span> <span class="st">'TCGA'</span> <span class="op">&amp;</span></span>
<span>    <span class="st">"cases.demographic.gender"</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="st">"female"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/results.html">results</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="../reference/ids.html">ids</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "cbfef004-b437-4d51-9d88-a2db50aa6481"</span></span>
<span><span class="co">## [2] "a9644274-13bb-4228-9b4f-14260ccc26eb"</span></span>
<span><span class="co">## [3] "096bd95f-9900-4db2-b1c4-103902c3b31f"</span></span>
<span><span class="co">## [4] "0a45f302-5748-48f3-9dc9-66c01843a68e"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="get-all-tcga-coad-case-ids-that-are-not-female">Get all TCGA-COAD case ids that are NOT female<a class="anchor" aria-label="anchor" href="#get-all-tcga-coad-case-ids-that-are-not-female"></a>
</h4>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span><span class="op">~</span> <span class="va">project.project_id</span> <span class="op">==</span> <span class="st">'TCGA-COAD'</span> <span class="op">&amp;</span></span>
<span>    <span class="st">"cases.demographic.gender"</span> <span class="op">%exclude%</span> <span class="st">"female"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/results.html">results</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="../reference/ids.html">ids</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "58facedb-fcb8-4ecf-8338-2bfa4947acef"</span></span>
<span><span class="co">## [2] "0a94eecf-4db2-4846-8383-c83ff02e4a9f"</span></span>
<span><span class="co">## [3] "8368d745-c74d-4236-ba75-16ca7aaeb3ca"</span></span>
<span><span class="co">## [4] "eb4e4e09-98b3-4e85-8dd2-75676ff2af14"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="get-all-tcga-cases-that-are-missing-gender">Get all TCGA cases that are missing gender<a class="anchor" aria-label="anchor" href="#get-all-tcga-cases-that-are-missing-gender"></a>
</h4>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span><span class="op">~</span> <span class="va">project.program.name</span> <span class="op">==</span> <span class="st">'TCGA'</span> <span class="op">&amp;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="st">"cases.demographic.gender"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/results.html">results</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="../reference/ids.html">ids</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "aebd0313-23be-46a8-abc6-b16c531c3a8e"</span></span>
<span><span class="co">## [2] "07119baf-64a7-454c-b1b0-c769b506a63d"</span></span>
<span><span class="co">## [3] "494d50b6-578e-441b-8195-4b4d26c0d810"</span></span>
<span><span class="co">## [4] "9b714a42-62e8-4b33-947e-6c4850725afd"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="get-all-tcga-cases-that-are-not-missing-gender">Get all TCGA cases that are NOT missing gender<a class="anchor" aria-label="anchor" href="#get-all-tcga-cases-that-are-not-missing-gender"></a>
</h4>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/query.html">cases</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span><span class="op">~</span> <span class="va">project.program.name</span> <span class="op">==</span> <span class="st">'TCGA'</span> <span class="op">&amp;</span></span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="st">"cases.demographic.gender"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/results.html">results</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="../reference/ids.html">ids</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "35243518-b086-4d76-a336-8c61a14f9ded"</span></span>
<span><span class="co">## [2] "df3362cb-0f6b-412e-8af4-c5606526be17"</span></span>
<span><span class="co">## [3] "6433f001-db5c-476b-83c7-23f4c5397ae9"</span></span>
<span><span class="co">## [4] "eb80244a-5f20-49a8-8f73-e92c14395895"</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="files">Files<a class="anchor" aria-label="anchor" href="#files"></a>
</h3>
<div class="section level4">
<h4 id="how-many-of-each-type-of-file-are-available">How many of each type of file are available?<a class="anchor" aria-label="anchor" href="#how-many-of-each-type-of-file-are-available"></a>
</h4>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">files</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/faceting.html">facet</a></span><span class="op">(</span><span class="st">'type'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/aggregations.html">aggregations</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">type</span></span></code></pre></div>
<pre><code><span><span class="co">##    doc_count                           key</span></span>
<span><span class="co">## 1     190236    annotated_somatic_mutation</span></span>
<span><span class="co">## 2     123377                 aligned_reads</span></span>
<span><span class="co">## 3      86801          structural_variation</span></span>
<span><span class="co">## 4      86592       simple_somatic_mutation</span></span>
<span><span class="co">## 5      58883           copy_number_segment</span></span>
<span><span class="co">## 6      46153          copy_number_estimate</span></span>
<span><span class="co">## 7      43618               gene_expression</span></span>
<span><span class="co">## 8      33639   aggregated_somatic_mutation</span></span>
<span><span class="co">## 9      33234              mirna_expression</span></span>
<span><span class="co">## 10     31716      masked_methylation_array</span></span>
<span><span class="co">## 11     30075                   slide_image</span></span>
<span><span class="co">## 12     26002        biospecimen_supplement</span></span>
<span><span class="co">## 13     15858        methylation_beta_value</span></span>
<span><span class="co">## 14     15635       masked_somatic_mutation</span></span>
<span><span class="co">## 15     13135           clinical_supplement</span></span>
<span><span class="co">## 16      7906            protein_expression</span></span>
<span><span class="co">## 17        84 secondary_expression_analysis</span></span>
<span><span class="co">## 18        67              pathology_report</span></span></code></pre>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">type</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">key</span>,y <span class="op">=</span> <span class="va">doc_count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'identity'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="overview_files/figure-html/filesVCFCount-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="find-gene-level-rna-seq-quantification-files-for-gbm">Find gene-level RNA-seq quantification files for GBM<a class="anchor" aria-label="anchor" href="#find-gene-level-rna-seq-quantification-files-for-gbm"></a>
</h4>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">files</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="../reference/available_fields.html">available_fields</a></span><span class="op">(</span><span class="st">'files'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span><span class="op">~</span> <span class="va">cases.project.project_id</span><span class="op">==</span><span class="st">'TCGA-GBM'</span> <span class="op">&amp;</span></span>
<span>               <span class="va">data_type</span><span class="op">==</span><span class="st">'Gene Expression Quantification'</span><span class="op">)</span></span>
<span><span class="va">q</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/faceting.html">facet</a></span><span class="op">(</span><span class="st">'analysis.workflow_type'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/aggregations.html">aggregations</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## list()</span></span></code></pre>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># so need to add another filter</span></span>
<span><span class="va">file_ids</span> <span class="op">=</span> <span class="va">q</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span><span class="op">~</span> <span class="va">cases.project.project_id</span><span class="op">==</span><span class="st">'TCGA-GBM'</span> <span class="op">&amp;</span></span>
<span>                            <span class="va">data_type</span><span class="op">==</span><span class="st">'Gene Expression Quantification'</span> <span class="op">&amp;</span></span>
<span>                            <span class="va">analysis.workflow_type</span> <span class="op">==</span> <span class="st">'STAR - Counts'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/select.html">select</a></span><span class="op">(</span><span class="st">'file_id'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/response.html">response_all</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/ids.html">ids</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="slicing">Slicing<a class="anchor" aria-label="anchor" href="#slicing"></a>
</h3>
<div class="section level4">
<h4 id="get-all-bam-file-ids-from-tcga-gbm">Get all BAM file ids from TCGA-GBM<a class="anchor" aria-label="anchor" href="#get-all-bam-file-ids-from-tcga-gbm"></a>
</h4>
<p><strong>I need to figure out how to do slicing reproducibly in a testing environment and for vignette building</strong>.</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">=</span> <span class="fu"><a href="../reference/query.html">files</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">GenomicDataCommons</span><span class="fu">::</span><span class="fu"><a href="../reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="../reference/available_fields.html">available_fields</a></span><span class="op">(</span><span class="st">'files'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/filtering.html">filter</a></span><span class="op">(</span><span class="op">~</span> <span class="va">cases.project.project_id</span> <span class="op">==</span> <span class="st">'TCGA-GBM'</span> <span class="op">&amp;</span></span>
<span>               <span class="va">data_type</span> <span class="op">==</span> <span class="st">'Aligned Reads'</span> <span class="op">&amp;</span></span>
<span>               <span class="va">experimental_strategy</span> <span class="op">==</span> <span class="st">'RNA-Seq'</span> <span class="op">&amp;</span></span>
<span>               <span class="va">data_format</span> <span class="op">==</span> <span class="st">'BAM'</span><span class="op">)</span></span>
<span><span class="va">file_ids</span> <span class="op">=</span> <span class="va">q</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/response.html">response_all</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/ids.html">ids</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bamfile</span> <span class="op">=</span> <span class="fu"><a href="../reference/slicing.html">slicing</a></span><span class="op">(</span><span class="va">file_ids</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,regions<span class="op">=</span><span class="st">"chr12:6534405-6538375"</span>,token<span class="op">=</span><span class="fu"><a href="../reference/gdc_token.html">gdc_token</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomicAlignments" class="external-link">GenomicAlignments</a></span><span class="op">)</span></span>
<span><span class="va">aligns</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicAlignments/man/readGAlignments.html" class="external-link">readGAlignments</a></span><span class="op">(</span><span class="va">bamfile</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<div class="section level3">
<h3 id="ssl-connection-errors">SSL connection errors<a class="anchor" aria-label="anchor" href="#ssl-connection-errors"></a>
</h3>
<ul>
<li>Symptom: Trying to connect to the API results in:</li>
</ul>
<pre><code>Error in curl::curl_fetch_memory(url, handle = handle) :
SSL connect error</code></pre>
<ul>
<li>Possible solutions: The <a href="http://stackoverflow.com/a/42599546/459633" class="external-link">issue is that the GDC supports only recent security Transport Layer Security (TLS)</a>, so the only known fix is to upgrade the system <code>openssl</code> to version 1.0.1 or later.
<ul>
<li>
<a href="https://github.com/Bioconductor/GenomicDataCommons/issues/35#issuecomment-284233510" class="external-link">[Mac OS]</a>,</li>
<li><a href="http://askubuntu.com/a/434245" class="external-link">[Ubuntu]</a></li>
<li>
<a href="https://www.liquidweb.com/kb/update-and-patch-openssl-for-the-ccs-injection-vulnerability/" class="external-link">[Centos/RHEL]</a>. After upgrading <code>openssl</code>, reinstall the R <code>curl</code> and <code>httr</code> packages.</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="sessioninfo">sessionInfo()<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.2 (2022-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 20.04.5 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0</span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] ggplot2_3.4.0             GenomicDataCommons_1.23.0</span></span>
<span><span class="co">## [3] magrittr_2.0.3            knitr_1.40               </span></span>
<span><span class="co">## [5] BiocStyle_2.24.0         </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] assertthat_0.2.1       rprojroot_2.0.3        digest_0.6.30         </span></span>
<span><span class="co">##  [4] utf8_1.2.2             R6_2.5.1               GenomeInfoDb_1.32.4   </span></span>
<span><span class="co">##  [7] stats4_4.2.2           evaluate_0.18          highr_0.9             </span></span>
<span><span class="co">## [10] httr_1.4.4             pillar_1.8.1           zlibbioc_1.42.0       </span></span>
<span><span class="co">## [13] rlang_1.0.6            curl_4.3.3             jquerylib_0.1.4       </span></span>
<span><span class="co">## [16] S4Vectors_0.34.0       rmarkdown_2.17         pkgdown_2.0.6         </span></span>
<span><span class="co">## [19] labeling_0.4.2         textshaping_0.3.6      desc_1.4.2            </span></span>
<span><span class="co">## [22] readr_2.1.3            stringr_1.4.1          RCurl_1.98-1.9        </span></span>
<span><span class="co">## [25] munsell_0.5.0          compiler_4.2.2         xfun_0.34             </span></span>
<span><span class="co">## [28] pkgconfig_2.0.3        systemfonts_1.0.4      BiocGenerics_0.42.0   </span></span>
<span><span class="co">## [31] htmltools_0.5.3        tidyselect_1.2.0       tibble_3.1.8          </span></span>
<span><span class="co">## [34] GenomeInfoDbData_1.2.8 bookdown_0.29          IRanges_2.30.1        </span></span>
<span><span class="co">## [37] fansi_1.0.3            withr_2.5.0            crayon_1.5.2          </span></span>
<span><span class="co">## [40] dplyr_1.0.10           tzdb_0.3.0             bitops_1.0-7          </span></span>
<span><span class="co">## [43] rappdirs_0.3.3         grid_4.2.2             jsonlite_1.8.3        </span></span>
<span><span class="co">## [46] gtable_0.3.1           lifecycle_1.0.3        DBI_1.1.3             </span></span>
<span><span class="co">## [49] scales_1.2.1           cli_3.4.1              stringi_1.7.8         </span></span>
<span><span class="co">## [52] cachem_1.0.6           farver_2.1.1           XVector_0.36.0        </span></span>
<span><span class="co">## [55] fs_1.5.2               xml2_1.3.3             bslib_0.4.1           </span></span>
<span><span class="co">## [58] ellipsis_0.3.2         ragg_1.2.4             generics_0.1.3        </span></span>
<span><span class="co">## [61] vctrs_0.5.0            tools_4.2.2            glue_1.6.2            </span></span>
<span><span class="co">## [64] purrr_0.3.5            hms_1.1.2              fastmap_1.1.0         </span></span>
<span><span class="co">## [67] yaml_2.3.6             colorspace_2.0-3       BiocManager_1.30.19   </span></span>
<span><span class="co">## [70] GenomicRanges_1.48.0   memoise_2.0.1          sass_0.4.2</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="developer-notes">Developer notes<a class="anchor" aria-label="anchor" href="#developer-notes"></a>
</h2>
<ul>
<li>The <code>S3</code> object-oriented programming paradigm is used.</li>
<li>We have adopted a functional programming style with functions and methods that often take an “object” as the first argument. This style lends itself to pipeline-style programming.</li>
<li>The GenomicDataCommons package uses the <a href="https://docs.gdc.cancer.gov/API/Users_Guide/Search_and_Retrieval/#alternative-request-format" class="external-link">alternative request format (POST)</a> to allow very large request bodies.</li>
</ul>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Martin Morgan, Sean Davis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
